# ☁️ AWS の責任共有モデル（Shared Responsibility Model）

AWS と利用者がそれぞれどこまで責任を負うのかを明確にして、  
セキュリティ事故を防ぐための考え方です。  
SAA 試験では**セキュリティ設計問題の根底**に必ず登場します。

---

## 🧩 基本の考え方

| 項目             | 内容                                                                 |
| ---------------- | -------------------------------------------------------------------- |
| **AWS の責任**   | 「クラウドの中身（インフラ）」を守る＝**クラウドのセキュリティ**     |
| **利用者の責任** | 「クラウド上の利用方法・データ」を守る＝**クラウド内のセキュリティ** |

> 💡 AWS は「環境を安全に保つ」責任。  
> 💡 利用者は「使い方を安全にする」責任。

---

## 🏗️ レイヤー別の責任範囲

| レイヤー         | AWS の責任                               | 利用者の責任                                   |
| ---------------- | ---------------------------------------- | ---------------------------------------------- |
| 物理設備         | データセンター、電源、冷却、アクセス制御 | なし（そもそも触れられない領域）               |
| ネットワーク     | 物理ネットワークの冗長化・保守           | VPC 設計、サブネット、セキュリティグループ設定 |
| 仮想化基盤       | ハイパーバイザーの保護                   | なし（制御不可。OS 以上が担当範囲）            |
| OS・ミドルウェア | -                                        | パッチ適用、設定管理、ログ管理                 |
| アプリケーション | -                                        | コード品質、脆弱性対策                         |
| データ           | -                                        | 暗号化、バックアップ、アクセス制御             |
| IAM              | -                                        | 最小権限、MFA、ユーザー管理                    |

> 🔍 **補足：** 物理ネットワークは AWS が保護しますが、VPC 内の論理ネットワーク（セキュリティグループやネットワーク ACL）は利用者が設定・監視する必要があります。

---

## ☁️ サービスモデル別の違い

| モデル                    | AWS の責任                   | 利用者の責任                         | 試験の狙い                             |
| ------------------------- | ---------------------------- | ------------------------------------ | -------------------------------------- |
| **IaaS**（EC2 など）      | 仮想化層・ハードウェア       | OS、アプリ、データ、IAM 管理         | 利用者責任が多い構成を理解しているか   |
| **PaaS**（RDS, ECS など） | OS や DB エンジンの運用      | データ保護、接続設定、認証設定       | マネージドサービスの境界を判断できるか |
| **SaaS**（WorkMail など） | アプリ運用・スケーリング全般 | データ分類・アクセス制御、利用者教育 | 利用者責任は最小限                     |

> 💬 **用語メモ**
>
> - **IaaS（Infrastructure as a Service）**: 仮想サーバーなどの基盤のみ提供。利用者が OS 以上を構築。
> - **PaaS（Platform as a Service）**: OS やミドルウェアまで AWS が提供。アプリとデータに集中できる。
> - **SaaS（Software as a Service）**: 完成済みアプリを提供。利用者はアカウント設計とデータ利用に注力。

---

## 🎯 試験で問われる観点

| 出題の狙い                           | 例題・意図                                              |
| ------------------------------------ | ------------------------------------------------------- |
| **どこまでが AWS の責任か？**        | RDS の OS パッチは AWS。EC2 のパッチは利用者。          |
| **マネージドサービス利用時の境界**   | 「運用を AWS が代行＝責任範囲が狭まる」と理解しているか |
| **設定ミスの責任**                   | S3 公開ミス・IAM 権限過剰 → 利用者責任                  |
| **暗号化と鍵管理の責任**             | KMS のキータイプによって AWS/利用者で変わる             |
| **IAM の最小権限原則を意識できるか** | Root ユーザー常用禁止、ロール分離などの理解             |

---

## 🧠 よく出る応用ケースと解釈のコツ

### ✅ ケース 1：EC2 vs RDS

| サービス | AWS の責任      | 利用者の責任               | 判断のコツ                                  |
| -------- | --------------- | -------------------------- | ------------------------------------------- |
| **EC2**  | 仮想化層        | OS パッチ、アプリ設定      | 「自分で SSH ログインできる＝利用者責任」   |
| **RDS**  | OS・DB エンジン | データ暗号化、ユーザー管理 | 「運用を代行してくれる＝ AWS 責任が増える」 |

---

### ✅ ケース 2：S3 の公開設定

- バケットの誤公開は**利用者責任**。
- AWS は機能提供者であり、設定はユーザー操作。

> 💡 **判断のコツ：**
> 「設定できるものは利用者責任」と覚える。  
> （S3 ポリシー、ACL、暗号化設定、IAM 権限など）

---

### ✅ ケース 3：KMS キー管理

| キータイプ                   | 管理者 | 責任                                                                       |
| ---------------------------- | ------ | -------------------------------------------------------------------------- |
| **AWS マネージドキー**       | AWS    | キー基盤は AWS。**ただし、どのリソースが使えるかの権限管理は利用者責任。** |
| **カスタマーマネージドキー** | 利用者 | キーの作成・ローテーション・ポリシー管理を含めて利用者責任                 |

> 💡 **判断のコツ：**
>
> - 「自分で作成したキーは自分で守る」＝**Customer-managed = 利用者責任**
> - AWS 管理キーを使う場合でも、キーを呼び出す IAM 権限やログ監査の設定は利用者の仕事。

---

### ✅ ケース 4：Lambda や Fargate

- インフラ・OS・スケーリング → AWS 責任
- コード・IAM ロール・環境変数 → 利用者責任

> 💡 **判断のコツ：**
> 「コードを自分で書くなら利用者責任、それ以外は AWS 責任」

---

## 🧩 責任範囲を見抜く TIPS 集（超重要）

| TIPS                                                  | 判断のコツ                                      | 補足                                 |
| ----------------------------------------------------- | ----------------------------------------------- | ------------------------------------ |
| 🧱 **“物理的に触れないもの”は AWS 責任**              | データセンター、電源、ラック、ネットワーク      | インフラは AWS が完全に管理          |
| 🧰 **“設定変更できるもの”は利用者責任**               | S3 公開設定、IAM ポリシー、セキュリティグループ | 誤設定による事故は利用者             |
| 🔐 **“キーや認証情報を作る・保管する”なら利用者責任** | KMS キー、Secrets Manager                       | 鍵管理とアクセス制御の理解           |
| 📦 **“運用を AWS が代行する”なら AWS 責任**           | RDS、ECS、Fargate                               | マネージドサービスの判断軸           |
| 🧑‍💻 **“アプリやコードを触れる”なら利用者責任**         | Lambda 関数、EC2 アプリ                         | 自分で管理できるものは全て対象       |
| 🚨 **“誤設定で漏れる”は 100%利用者責任**              | S3 誤公開、セキュリティグループ全開放           | AWS は仕組みを提供するだけ           |
| 📈 **“監視ログを設定する”のは利用者責任**             | CloudTrail, Config, GuardDuty の有効化          | AWS は記録するが、**使うのは利用者** |

---

## 💬 試験頻出例と解答パターン

### 問題 1

> EC2 の OS にセキュリティパッチを適用する責任は？

✅ **答え：利用者の責任**  
🧭 **理由：** EC2 は IaaS。OS 管理・更新は利用者が実施。

---

### 問題 2

> Amazon RDS でデータベースエンジンにパッチを当てるのは？

✅ **答え：AWS の責任**  
🧭 **理由：** RDS は PaaS。AWS が DB エンジンを自動更新。

---

### 問題 3

> S3 バケットの誤設定で情報漏えいした。誰の責任？

✅ **答え：利用者の責任**  
🧭 **理由：** バケットポリシーを設定したのは利用者。AWS は機能提供のみ。

---

### 問題 4

> Lambda 関数で API キーを環境変数に平文保存していた。誰の責任？

✅ **答え：利用者の責任**  
🧭 **理由：** コード・環境変数・権限設定はすべて利用者管理。

---

## 🧾 まとめ

| 覚えるポイント | 内容                                     |
| -------------- | ---------------------------------------- |
| AWS の責任     | クラウド**そのもの**のセキュリティ       |
| 利用者の責任   | クラウド**の中での使い方**のセキュリティ |
| 境界判断のコツ | 「触れる＝利用者」「触れない＝ AWS」     |
| 試験のねらい   | どちらの責任かを即答できること           |

---

> ✅ **最終 TIPS（超重要）**
>
> - **「AWS が管理する部分は触れない」** → AWS 責任
> - **「設定画面や CLI で触れる部分」** → 利用者責任
> - **「マネージドサービスは AWS が多め、IaaS は利用者多め」**
> - **「設定ミス＝ 100%利用者責任」**（S3・IAM・SG 系は特に）
